{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "c7ddfa59_09a50e66",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2021-08-21T00:58:12Z",
      "side": 1,
      "message": "We should also detect the migration from v3.4 in the init step and automatically set this flag.\n\nAlso, when it isn\u0027t a migration but a new setup, we should ask in the init step if stream events should be enabled or not.",
      "revId": "7843801ebdc031fbb883007ae0f4d40be794f9f6",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "8382858c_21c37d04",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1072905
      },
      "writtenOn": "2021-08-23T18:51:05Z",
      "side": 1,
      "message": "\u003e We should also detect the migration from v3.4 in the init step and automatically set this flag.\n\nI am not sure I follow the rationale for it: Mightn\u0027t setting this flag automatically lead to errors?\n\nFor example, if we were to automatically set this flag in a multi-site environment, then gerrit events would end up being streamed twice, since multi-site is also streaming events to the topic.\n\nAlso flipping this flag without ensuring the topic has been created beforehand, would potentially lead to errors anyway, so I think it can only be a decision taken by the admin, rather than automatically.\n\nWDYT?\n\n\u003e \n\u003e Also, when it isn\u0027t a migration but a new setup, we should ask in the init step if stream events should be enabled or not.\n\nYep, I think this makes sense.\npossibly we\u0027ll do it in a follow up section and leave this change only for the conditional streaming, WDYT?",
      "parentUuid": "c7ddfa59_09a50e66",
      "revId": "7843801ebdc031fbb883007ae0f4d40be794f9f6",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "b4e37b7b_aaddf82c",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1072905
      },
      "writtenOn": "2021-08-26T16:43:05Z",
      "side": 1,
      "message": "\u003e \u003e We should also detect the migration from v3.4 in the init step and automatically set this flag.\n\u003e \n\u003e I am not sure I follow the rationale for it: Mightn\u0027t setting this flag automatically lead to errors?\n\u003e \n\u003e For example, if we were to automatically set this flag in a multi-site environment, then gerrit events would end up being streamed twice, since multi-site is also streaming events to the topic.\n\u003e \n\u003e Also flipping this flag without ensuring the topic has been created beforehand, would potentially lead to errors anyway, so I think it can only be a decision taken by the admin, rather than automatically.\n\u003e \n\u003e WDYT?\n\n@Luca any feedback on this?\n\n\u003e \n\u003e \u003e \n\u003e \u003e Also, when it isn\u0027t a migration but a new setup, we should ask in the init step if stream events should be enabled or not.\n\u003e \n\u003e Yep, I think this makes sense.\n\u003e possibly we\u0027ll do it in a follow up section and leave this change only for the conditional streaming, WDYT?\n\nThis is now done as a follow up change in this chain [1]\n\n\n[1]https://gerrit-review.googlesource.com/c/plugins/events-kafka/+/316522",
      "parentUuid": "8382858c_21c37d04",
      "revId": "7843801ebdc031fbb883007ae0f4d40be794f9f6",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "59b30a4e_88e8bff7",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/kafka/Module.java",
        "patchSetId": 2
      },
      "lineNbr": 37,
      "author": {
        "id": 1025452
      },
      "writtenOn": "2021-08-26T18:06:23Z",
      "side": 1,
      "message": "nit: How about having simple boolean here e.g. `isSendStreamEvents`? you can safely ignore it in case you plan to use more properties from the config ;)",
      "range": {
        "startLine": 37,
        "startChar": 9,
        "endLine": 37,
        "endChar": 38
      },
      "revId": "7843801ebdc031fbb883007ae0f4d40be794f9f6",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "473b97cf_b9b277f4",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/kafka/Module.java",
        "patchSetId": 2
      },
      "lineNbr": 45,
      "author": {
        "id": 1083454
      },
      "writtenOn": "2021-08-23T19:30:49Z",
      "side": 1,
      "message": "Why not binding the StreamEventPublisher from events-broker lib?",
      "range": {
        "startLine": 45,
        "startChar": 56,
        "endLine": 45,
        "endChar": 70
      },
      "revId": "7843801ebdc031fbb883007ae0f4d40be794f9f6",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "7c34c0ab_a57d93c7",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/kafka/Module.java",
        "patchSetId": 2
      },
      "lineNbr": 45,
      "author": {
        "id": 1072905
      },
      "writtenOn": "2021-08-23T19:52:02Z",
      "side": 1,
      "message": "I didn\u0027t want to squeeze two changes into one.\n\n1 - Publishing stream events when sendStreamEvents configuration is set.\n2 - Replacing the current implementation with the StreamEventPublisher one.\n\nFollow up change?",
      "parentUuid": "473b97cf_b9b277f4",
      "range": {
        "startLine": 45,
        "startChar": 56,
        "endLine": 45,
        "endChar": 70
      },
      "revId": "7843801ebdc031fbb883007ae0f4d40be794f9f6",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "d9a416a9_f45b5f1a",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/kafka/Module.java",
        "patchSetId": 2
      },
      "lineNbr": 45,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2021-08-24T22:12:04Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "7c34c0ab_a57d93c7",
      "range": {
        "startLine": 45,
        "startChar": 56,
        "endLine": 45,
        "endChar": 70
      },
      "revId": "7843801ebdc031fbb883007ae0f4d40be794f9f6",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    }
  ]
}