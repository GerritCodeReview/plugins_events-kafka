{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "b15bf099_3df6c7d4",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/kafka/api/KafkaBrokerApi.java",
        "patchSetId": 18
      },
      "lineNbr": 92,
      "author": {
        "id": 1083454
      },
      "writtenOn": "2023-09-07T07:50:46Z",
      "side": 1,
      "message": "I just realised that we have potential issue here. We do not have consistent behaviour with `InProcessBrokerAPI` if you call `InProcessBrokerAPI.topicSubscribersWithGroupId` it will return only subscribers which used `receiveAsync` with group id. In this class if you call `KafkaBrokerApi.topicSubscribersWithGroupId` it will return all subscribers. This can cause situation that some other code will call both `topicSubscribersWithGroupId` and `topicSubscribers` and will register some subscribers twice",
      "range": {
        "startLine": 86,
        "startChar": 0,
        "endLine": 92,
        "endChar": 37
      },
      "revId": "41587f88a742c4076b67ef2fc254977a6dc38f36",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "05964e50_1c7b50db",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/kafka/api/KafkaBrokerApi.java",
        "patchSetId": 18
      },
      "lineNbr": 92,
      "author": {
        "id": 1149185
      },
      "writtenOn": "2023-09-07T08:27:52Z",
      "side": 1,
      "message": "am I right if I state that in runtime we should have either subscribers without groupId or subscribers with groupId?",
      "parentUuid": "b15bf099_3df6c7d4",
      "range": {
        "startLine": 86,
        "startChar": 0,
        "endLine": 92,
        "endChar": 37
      },
      "revId": "41587f88a742c4076b67ef2fc254977a6dc38f36",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "d1f01ee2_d7373f40",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/kafka/api/KafkaBrokerApi.java",
        "patchSetId": 18
      },
      "lineNbr": 92,
      "author": {
        "id": 1149185
      },
      "writtenOn": "2023-09-07T09:51:14Z",
      "side": 1,
      "message": "I have created another list exclusively for subscribers with GroupId. It is a conservative way of maintaining mutual exclusivity. \n\nThe other alternative was to keep the same list `subscribers` for both types of subscribers (with and without groupId) and do a filtering in the `receiveAsync` methods based on if `KafkaEventSubscriber` has different groupId than the one in the configuration. Personally I like this but because `KafkaEventSubscriber` is mutable I dont feel safe. If you prefer this approach because you know more the code, i will change it.",
      "parentUuid": "05964e50_1c7b50db",
      "range": {
        "startLine": 86,
        "startChar": 0,
        "endLine": 92,
        "endChar": 37
      },
      "revId": "41587f88a742c4076b67ef2fc254977a6dc38f36",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "93c033ac_db430374",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/kafka/api/KafkaBrokerApi.java",
        "patchSetId": 18
      },
      "lineNbr": 92,
      "author": {
        "id": 1149185
      },
      "writtenOn": "2023-09-07T09:59:48Z",
      "side": 1,
      "message": "I am not quite sure that the way I combine them is the correct one because is creating a copy of both and create a new one.",
      "parentUuid": "d1f01ee2_d7373f40",
      "range": {
        "startLine": 86,
        "startChar": 0,
        "endLine": 92,
        "endChar": 37
      },
      "revId": "41587f88a742c4076b67ef2fc254977a6dc38f36",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "d6878a74_e40e99c1",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/kafka/subscribe/KafkaEventRestSubscriber.java",
        "patchSetId": 18
      },
      "lineNbr": 179,
      "author": {
        "id": 1083454
      },
      "writtenOn": "2023-09-07T07:50:46Z",
      "side": 1,
      "message": "we should return group id",
      "range": {
        "startLine": 177,
        "startChar": 0,
        "endLine": 179,
        "endChar": 3
      },
      "revId": "41587f88a742c4076b67ef2fc254977a6dc38f36",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "fed3664f_a6ce741a",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/kafka/subscribe/KafkaEventRestSubscriber.java",
        "patchSetId": 18
      },
      "lineNbr": 179,
      "author": {
        "id": 1149185
      },
      "writtenOn": "2023-09-07T08:25:38Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "d6878a74_e40e99c1",
      "range": {
        "startLine": 177,
        "startChar": 0,
        "endLine": 179,
        "endChar": 3
      },
      "revId": "41587f88a742c4076b67ef2fc254977a6dc38f36",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    }
  ]
}